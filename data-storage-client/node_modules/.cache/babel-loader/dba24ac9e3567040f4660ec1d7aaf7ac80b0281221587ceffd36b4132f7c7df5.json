{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import axios from\"axios\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function FileList(){const[files,setFiles]=useState([]);const[loading,setLoading]=useState(true);const fetchFiles=async()=>{try{const token=localStorage.getItem(\"token\");// console.log(\"Token being sent:\", token);\nconst res=await axios.get(\"http://localhost:5000/api/files/list\",{headers:{Authorization:\"Bearer \".concat(token)}});// console.log(\"Files fetched:\", res.data.files);\nsetFiles(res.data.files);}catch(err){console.error(\"Failed to fetch files\",err);}finally{setLoading(false);}};const handleDelete=async fileId=>{try{const token=localStorage.getItem(\"token\");await axios.delete(\"http://localhost:5000/api/files/delete/\".concat(fileId),{headers:{Authorization:\"Bearer \".concat(token)}});fetchFiles();// Refresh list\n}catch(err){console.error(\"Failed to delete file\",err);}};const handleDownload=async(fileId,originalName)=>{try{const token=localStorage.getItem(\"token\");const response=await axios.get(\"http://localhost:5000/api/files/download/\".concat(fileId),{headers:{Authorization:\"Bearer \".concat(token)},responseType:\"blob\"// Important: fetch file as blob\n});// Create a blob link to download\nconst url=window.URL.createObjectURL(new Blob([response.data]));const link=document.createElement(\"a\");link.href=url;link.setAttribute(\"download\",originalName);document.body.appendChild(link);link.click();link.parentNode.removeChild(link);}catch(err){console.error(\"Failed to download file\",err);}};useEffect(()=>{fetchFiles();},[]);return/*#__PURE__*/_jsx(\"div\",{className:\"container mt-4 \",children:/*#__PURE__*/_jsx(\"div\",{className:\"card shadow-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"card-title text-center mb-4\",children:\"\\uD83D\\uDCC4 Your Files\"}),loading?/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-muted\",children:\"Loading files...\"}):files.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-muted\",children:\"No files uploaded yet.\"}):/*#__PURE__*/_jsx(\"ul\",{className:\"list-group\",children:files.map(file=>/*#__PURE__*/_jsxs(\"li\",{className:\"list-group-item d-flex justify-content-between align-items-center fade-in\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:file.originalName}),file.uploadTime&&/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted ms-2\",children:[\"(\",new Date(file.uploadTime).toLocaleString(),\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDownload(file._id,file.originalName),className:\"btn btn-sm btn-primary me-2\",children:\"\\u2B07\\uFE0F Download\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(file._id),className:\"btn btn-sm btn-danger\",children:\"\\u274C Delete\"})]})]},file._id))})]})})});}export default FileList;","map":{"version":3,"names":["React","useEffect","useState","axios","jsx","_jsx","jsxs","_jsxs","FileList","files","setFiles","loading","setLoading","fetchFiles","token","localStorage","getItem","res","get","headers","Authorization","concat","data","err","console","error","handleDelete","fileId","delete","handleDownload","originalName","response","responseType","url","window","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","body","appendChild","click","parentNode","removeChild","className","children","length","map","file","uploadTime","Date","toLocaleString","onClick","_id"],"sources":["D:/react/myFiles/data-storage-client/src/components/FileList.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\n\r\n\r\nfunction FileList() {\r\n  const [files, setFiles] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const fetchFiles = async () => {\r\n    try {\r\n      const token = localStorage.getItem(\"token\");\r\n      // console.log(\"Token being sent:\", token);\r\n      const res = await axios.get(\"http://localhost:5000/api/files/list\", {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      // console.log(\"Files fetched:\", res.data.files);\r\n      setFiles(res.data.files);\r\n    } catch (err) {\r\n      console.error(\"Failed to fetch files\", err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (fileId) => {\r\n    try {\r\n      const token = localStorage.getItem(\"token\");\r\n      await axios.delete(`http://localhost:5000/api/files/delete/${fileId}`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      fetchFiles(); // Refresh list\r\n    } catch (err) {\r\n      console.error(\"Failed to delete file\", err);\r\n    }\r\n  };\r\n\r\nconst handleDownload = async (fileId, originalName) => {\r\n  try {\r\n    const token = localStorage.getItem(\"token\");\r\n    const response = await axios.get(`http://localhost:5000/api/files/download/${fileId}`, {\r\n      headers: { Authorization: `Bearer ${token}` },\r\n      responseType: \"blob\", // Important: fetch file as blob\r\n    });\r\n\r\n    // Create a blob link to download\r\n    const url = window.URL.createObjectURL(new Blob([response.data]));\r\n    const link = document.createElement(\"a\");\r\n    link.href = url;\r\n    link.setAttribute(\"download\", originalName);\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    link.parentNode.removeChild(link);\r\n  } catch (err) {\r\n    console.error(\"Failed to download file\", err);\r\n  }\r\n};\r\n\r\n\r\n  useEffect(() => {\r\n    fetchFiles();\r\n  }, []);\r\n\r\n  return (\r\n    \r\n<div className=\"container mt-4 \">\r\n  <div className=\"card shadow-sm\">\r\n    <div className=\"card-body\">\r\n      <h2 className=\"card-title text-center mb-4\">üìÑ Your Files</h2>\r\n\r\n      {loading ? (\r\n        <p className=\"text-center text-muted\">Loading files...</p>\r\n      ) : files.length === 0 ? (\r\n        <p className=\"text-center text-muted\">No files uploaded yet.</p>\r\n      ) : (\r\n        <ul className=\"list-group\">\r\n          {files.map((file) => (\r\n            <li\r\n              key={file._id}\r\n              className=\"list-group-item d-flex justify-content-between align-items-center fade-in\"\r\n            >\r\n              <div>\r\n                <strong>{file.originalName}</strong>\r\n                {file.uploadTime && (\r\n                  <small className=\"text-muted ms-2\">\r\n                    ({new Date(file.uploadTime).toLocaleString()})\r\n                  </small>\r\n                )}\r\n              </div>\r\n              <div>\r\n                <button\r\n                  onClick={() => handleDownload(file._id, file.originalName)}\r\n                  className=\"btn btn-sm btn-primary me-2\"\r\n                >\r\n                  ‚¨áÔ∏è Download\r\n                </button>\r\n                <button\r\n                  onClick={() => handleDelete(file._id)}\r\n                  className=\"btn btn-sm btn-danger\"\r\n                >\r\n                  ‚ùå Delete\r\n                </button>\r\n              </div>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      )}\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n  );\r\n}\r\n\r\nexport default FileList;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}